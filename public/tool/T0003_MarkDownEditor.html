<!DOCTYPE html>

<html lang="ja">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, user-scalable=no" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <title>MarkDownEditor │ Pico-Piko-Nano</a></title>
    <meta name="description" content="marked.jsを使用したmd→htmlエディタ" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/marked/0.3.2/marked.min.js"></script>
    <style type="text/css">
        .boxContainer {
            overflow: hidden;
        }

        body {
            margin: 0;
            padding: 0;
            font-size: 16px;
        }

        .box {
            float: left;
            width: 30vw;
            height: 90vh;
            margin: 5px;
        }

        h2 {
            font-size: 14px;
            margin: 0;
            padding: 0;
        }

        textarea {
            font-size: 16px;
            width: 100%;
            height: 95vh;
        }

        #pa {
            overflow: scroll;
            height: 95vh;
        }

        table,
        td,
        th {
            border: solid 1px;
            border-collapse: collapse;
        }

        blockquote {
            background: #f5f5f5;
            color: #555;
            border-left: 4px solid #009FB7;
            width: 500px;
            padding: 10px;
            margin: 10px auto;
        }

        #sample {
            font-size: 16px;
            font-weight: normal;
            color: #5555FF;
        }

        #clear {
            font-size: 16px;
            font-weight: normal;
            color: #009900;
        }
    </style>
</head>

<body>
    <header>MarkDownEditor │ <a href="/">Pico-Piko-Nano</a></header>
    <div class="boxContainer">
        <div>
            <span id="sample">[sample]</span>
            <span id="clear">[clear]</span>
        </div>
        <div class="box" id='editor'>
            <h2>
                Editor　
            </h2>
            <textarea class='ta' onkeypress="sync()"></textarea>
        </div>
        <div class="box" id='html'>
            <h2>Html</h2>
            <textarea class='ta'></textarea>
        </div>
        <div class="box" id='preview'>
            <h2>Preview</h2>
            <div id="pa"></div>
        </div>
    </div>
</body>

</html>

<script type="text/javascript">
    //『marked.js』 を使ってブラウザ上で markdown を html に変換する
    // 要素を取得
    const el_editor = document.querySelector('#editor .ta');
    const el_html = document.querySelector('#html .ta');
    const el_preview = document.querySelector('#pa');
    const el_sample = document.querySelector('#sample');
    const el_clear = document.querySelector('#clear');

    //入力状態の確定
    const sync = function (init) {
        // 改行時に更新
        if (init != true && event.keyCode != 13) {
            return;
        }

        if (el_editor.value !== sample_text &&
            el_editor.value.length > 0
        ) {
            // ブラウザのローカルストレージに保存
            localStorage.setItem('md', el_editor.value);
        }

        const value = el_editor.value;   // テキストエリアから値を取得
        const md = marked(value);       // マークダウンに変換
        //console.log(md);                // コンソールに出力

        el_html.value = md;  // htmlタグの表示
        el_preview.innerHTML = md;       //　プレビュー表示
    }

    window.onload = function () {
        if (access_count() == 1 || el_editor.value.length == 0) {
            el_editor.value = sample_text;
        }

        // ブラウザのローカルストレージから前回のデータを取得
        el_editor.value = localStorage.getItem('md')
        // 初回更新
        sync(true);

    };

    // サンプルテキストのクリック
    el_sample.onclick = function () {
        console.log("sample click");
        el_editor.value = sample_text;
        sync(true);
    };

    // クリアテキストのクリック
    el_clear.onclick = function () {
        console.log("clear click");
        el_editor.value = "";
        sync(false);
    };

    // アクセス回数カウント
    var access_count = function () {
        let count = Number(localStorage.getItem('access'));
        count++;
        localStorage.setItem('access', count);
        console.log("access_count = " + count);
        return count;
    }

    // 以下はヒアドキュメント形式のサンプル文字列
    const sample_text = `# MarkDown Editor
## 改行するとプレビュー更新＋ブラウザ保存されます
### 見出し
#### サンプル


1. 番号リスト
2. リスト
3. リスト
 1. リスト


- AA
- BB
 - cc
   - dd


|項目1|項目2|項目3|
|:--|:--:|--:|
|A|B|C|
|E|F|G|


[Googleへのリンク](http://google.com/)

---

文章内で改行をするなら  
末尾に半角スペースを2個入れる  

入れないと
改行しても
1行で
表示されます

---

**太字**

<font color="Red">色を付けるならhtmlタグで囲う</font>


\`\`\`c++
int main(void){
    printf("コードをそのまま表示");
    return 0;
}

\`\`\`
> 引用  
> 引用  
`;
</script>